
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Day 4, Session 6 - ‘Segment Anything’ Model (SAM) for Microscopy &#8212; BAB3 (Bioimage Analysis Beginnings Broad Bootcamp) Lab Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MicroSAM/MicroSAM_workshop';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Day 5, Session 2 - Segmenting Data with Cellpose" href="../Cellpose/CellposeIntro.html" />
    <link rel="prev" title="Day 4, Session 2 - Interfacing CellProfiler with other software tools via files and plugins" href="../BeginnerSegmentation/BeginnerSegmentationPlugins.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/CLab_Square.png" class="logo__image only-light" alt="BAB3 (Bioimage Analysis Beginnings Broad Bootcamp) Lab Manual - Home"/>
    <script>document.write(`<img src="../_static/CLab_Square.png" class="logo__image only-dark" alt="BAB3 (Bioimage Analysis Beginnings Broad Bootcamp) Lab Manual - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to BAB3
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs and Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../developing_intutions.html">Day 1, Exercise 3: developing image processing intutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Piximi_ManualAnnotation/Piximi.html">Day 1, Exercise 5 - Making manual annotations with Piximi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BeginnerSegmentation/CPbeginner_Segmentation.html">Day 2, exercise 2: Introduction to CellProfiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AdvancedSegmentation/BBBC022_AnalysisExercise.html">Day 2, exercise 3: Advanced segmentation and organelle analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Translocation/Translocation.html">Day 2, exercise 5: Segmentation and Classification with CellProfiler and CellProfiler Analyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ilastik/PixelClassification.html">Day 3, session 2: Practical introduction to ilastik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../QuPath_demo/QuPath_demo.html">Day 3, session 3: Practical introduction to QuPath</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BeginnerSegmentation/BeginnerSegmentationPlugins.html">Day 4, Session 2 - Interfacing CellProfiler with other software tools via files and plugins</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Day 4, Session 6 - ‘Segment Anything’ Model (SAM) for Microscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Cellpose/CellposeIntro.html">Day 5, Session 2 - Segmenting Data with Cellpose</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../slides_et_al.html">Links to slides and other course materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../links.html">Helpful links for now and the future</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/MicroSAM/MicroSAM_workshop.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Day 4, Session 6 - ‘Segment Anything’ Model (SAM) for Microscopy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microsam-segment-anything-model-for-microscopy">MicroSAM: ‘Segment Anything’ Model for Microscopy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-data"><strong>Lab Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-an-image-and-calculating-embeddings">Loading an image and calculating embeddings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#image-annotation-in-2d-documentation-and-video-tutorial">Image annotation in 2D (Documentation  and Video tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotate-an-entire-folder-the-image-series-annotator-documentation-and-video-tutorial">Annotate an entire folder: The image Series Annotator (Documentation and Video tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#image-annotation-in-3d-documentation-and-video-tutorial">Image Annotation in 3D (Documentation and Video Tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercise-try-samj-in-fiji">Bonus Exercise: try SAMJ in Fiji</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="day-4-session-6-segment-anything-model-sam-for-microscopy">
<h1>Day 4, Session 6 - ‘Segment Anything’ Model (SAM) for Microscopy<a class="headerlink" href="#day-4-session-6-segment-anything-model-sam-for-microscopy" title="Link to this heading">#</a></h1>
<p>*Lab authors: Esteban A. Miglietta .</p>
<hr class="docutils" />
<section id="microsam-segment-anything-model-for-microscopy">
<h2>MicroSAM: ‘Segment Anything’ Model for Microscopy<a class="headerlink" href="#microsam-segment-anything-model-for-microscopy" title="Link to this heading">#</a></h2>
<p>Segment Anything for Microscopy (or MicroSAM) is a tool for interactive and automatic annotation for microscopy data. It is built on top of <a class="reference external" href="https://segment-anything.com/">the Segment Anything Model</a> (aka. SAM), a foundational model developed by Meta AI for prompt-based and automatic segmentation of images. The original SAM model was trained on millions of annotated masks from thousands of images (mostly natural images, but some scientific and medical images as well). MicroSAM is a specific implementation of SAM which specializes it for microscopy and other biomedical imaging data.</p>
<p>You can find all the documentation for this tool <a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#annotation-tools">HERE</a>.</p>
<p>While you can use MicroSAM directly from the <a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#using-the-command-line-interface-cli">command line</a> or as a <a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#using-the-python-library">Python library</a> (there’s even <a class="reference external" href="https://github.com/computational-cell-analytics/micro-sam/blob/master/notebooks/quick_start.ipynb">quick start jupyter notebooks</a> that you can run online on Kaggle or Google Colab), we will use the <strong>MicroSAM Napari plugin</strong> for this workshop.</p>
</section>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Learn about SAM and it’s specific implementation for microscopy: MicroSAM</p></li>
<li><p>Explore MicroSAM as a tool for aiding in manual annotations in Napari, using the plugin</p></li>
<li><p>Explore the limitations of the model</p></li>
</ul>
<section id="lab-data">
<h3><strong>Lab Data</strong><a class="headerlink" href="#lab-data" title="Link to this heading">#</a></h3>
<p>You can download some sample images from <a class="reference external" href="https://drive.google.com/drive/folders/1NOt_OeMVr6Y5ZK5CrYtG97-P05yABHlx?usp=sharing">this Drive folder</a></p>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p>Using Pixi:
Clone the <strong>BAB3</strong> repo locally (during the course, you should have already done this part!) and <code class="docutils literal notranslate"><span class="pre">cd</span></code> into that directory, then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">pixi_envs</span><span class="o">/</span><span class="n">microsam</span> <span class="c1">#go to the directory containing the pixi files</span>
<span class="n">pixi</span> <span class="n">shell</span> <span class="o">--</span><span class="n">frozen</span> <span class="c1">#activate the new microsam environment (and install, if not already installed)</span>
</pre></div>
</div>
<p>If succesfull, you should see <code class="docutils literal notranslate"><span class="pre">(microsam)</span></code> before your command line prompt. Within this Pixi shell, you should have everything you need for this workshop.</p>
<p>You can always exit the Pixi environment using the <code class="docutils literal notranslate"><span class="pre">exit</span></code> command.</p>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises:<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="loading-an-image-and-calculating-embeddings">
<h3>Loading an image and calculating embeddings<a class="headerlink" href="#loading-an-image-and-calculating-embeddings" title="Link to this heading">#</a></h3>
<p>In order to use the MicroSAM models to segment the image, first we need to use the model to compute a simplified representation of the image, aka. an <em>embedding</em>.</p>
<ul class="simple">
<li><p>Open napari using the command <code class="docutils literal notranslate"><span class="pre">napari</span></code> in the command line</p></li>
<li><p>Load a sample image from  <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Open</span> <span class="pre">Sample</span> <span class="pre">&gt;</span> <span class="pre">SegmentAnything</span> <span class="pre">for</span> <span class="pre">Microscopy</span></code>. We recommend starting with <code class="docutils literal notranslate"><span class="pre">HeLa</span> <span class="pre">2d</span> <span class="pre">example</span> <span class="pre">data</span></code> for 2D segmentation.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>NOTE
Currently, <strong>MicroSAM only supports either single channel (grayscale) or 3-channel RGB images</strong>. If you want to work with a multichannel image, you will need to convert it to one of these formats before processing with MicroSAM.</p>
</div>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/Sample_images.png"><img alt="../_images/Sample_images.png" src="../_images/Sample_images.png" style="width: 500px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 49 </span><span class="caption-text">Sample images menu.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<aside class="margin sidebar">
<p class="sidebar-title">NOTE</p>
<p>The very first time you open a sample image, the plugin will first download it, which might take a few seconds.</p>
</aside>
<ul class="simple">
<li><p>Go to <code class="docutils literal notranslate"><span class="pre">Plugins</span> <span class="pre">&gt;</span> <span class="pre">SegmentAnything</span> <span class="pre">for</span> <span class="pre">Microscopy</span> <span class="pre">&gt;</span> <span class="pre">2d</span> <span class="pre">annotator</span></code>.</p></li>
<li><p>In the plugin window, choose the image for which to compute the embeddings in the <code class="docutils literal notranslate"><span class="pre">Image</span> <span class="pre">Layer</span></code> menu and choose the appropriate <code class="docutils literal notranslate"><span class="pre">Model</span></code> according to the type of images to segment.</p></li>
<li><p>In the Embedding Settings menu, choose the <code class="docutils literal notranslate"><span class="pre">model</span> <span class="pre">size</span></code> (bigger) and change directory for saving embeddings</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">Embeddings</span></code> with the default parameters (check where the embeddings are saved, you can specify a different location).</p></li>
</ul>
<aside class="margin sidebar">
<p class="sidebar-title">NOTE</p>
<p>The very first time you run any model, the plugin will first download the model weights, which might take a few minutes.</p>
</aside>
</section>
<section id="image-annotation-in-2d-documentation-and-video-tutorial">
<h3>Image annotation in 2D (<a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#annotator-2d">Documentation</a>  and <a class="reference external" href="https://www.youtube.com/watch?v=9xjJBg_Bfuc&amp;amp;ab_channel=ComputationalCellAnalytics">Video tutorial</a>)<a class="headerlink" href="#image-annotation-in-2d-documentation-and-video-tutorial" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Segment cells using either bounding box prompts or positive/negative point prompts</p></li>
</ul>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/2d_annotation.png"><img alt="../_images/2d_annotation.png" src="../_images/2d_annotation.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 50 </span><span class="caption-text">2D annotation tool using polygons or point prompts.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Try prompting the plugin to segment structures of varying sizes.</p>
</aside>
<ul class="simple">
<li><p>You can also try to do an <code class="docutils literal notranslate"><span class="pre">Automatic</span> <span class="pre">Segmentation</span></code></p></li>
</ul>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/automatic_segmentation.png"><img alt="../_images/automatic_segmentation.png" src="../_images/automatic_segmentation.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 51 </span><span class="caption-text">Automatic segmentation</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Choose a <code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">path</span></code>, where you want to store the segmentation masks that you generate.</p></li>
<li><p>Remember to <code class="docutils literal notranslate"><span class="pre">Commit</span></code> your segmented objects to save them!</p></li>
</ul>
</section>
<section id="annotate-an-entire-folder-the-image-series-annotator-documentation-and-video-tutorial">
<h3>Annotate an entire folder: The image Series Annotator (<a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#image-series-annotator">Documentation</a> and <a class="reference external" href="https://www.youtube.com/watch?v=HqRoImdTX3c&amp;amp;ab_channel=ComputationalCellAnalytics">Video tutorial</a>)<a class="headerlink" href="#annotate-an-entire-folder-the-image-series-annotator-documentation-and-video-tutorial" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Go to <code class="docutils literal notranslate"><span class="pre">Plugins</span> <span class="pre">&gt;</span> <span class="pre">SegmentAnything</span> <span class="pre">for</span> <span class="pre">Microscopy</span> <span class="pre">&gt;</span> <span class="pre">Image</span> <span class="pre">Series</span> <span class="pre">Annotator</span></code>.</p></li>
<li><p>As before, select the <code class="docutils literal notranslate"><span class="pre">Model</span></code> according to the image type, and it’s <code class="docutils literal notranslate"><span class="pre">Size</span></code>.</p></li>
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">Input</span> <span class="pre">Folder</span></code>, <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">Folder</span></code> and <code class="docutils literal notranslate"><span class="pre">embeddings</span> <span class="pre">save</span> <span class="pre">path</span></code> (each one should be a different folder, named accordingly).</p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Your input folder should <strong>ONLY</strong> contain your images and nothing else (like other files or other subfolders), otherwise the plugin will error.</p>
</div>
<ul class="simple">
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Annotate</span> <span class="pre">Images</span></code>. This will calculate the embeddings for all the images in the folder so it might take a while.</p></li>
<li><p>When the embedding computations are done, segment the image the same way you did before and click <code class="docutils literal notranslate"><span class="pre">Next</span></code> (or hit <code class="docutils literal notranslate"><span class="pre">N</span></code>) to move to the next image in the directory and continue annotating.</p></li>
</ul>
</section>
<section id="image-annotation-in-3d-documentation-and-video-tutorial">
<h3>Image Annotation in 3D (<a class="reference external" href="https://computational-cell-analytics.github.io/micro-sam/micro_sam.html#annotator-3d">Documentation</a> and <a class="reference external" href="https://www.youtube.com/watch?v=nqpyNQSyu74&amp;amp;ab_channel=ComputationalCellAnalytics">Video Tutorial</a>)<a class="headerlink" href="#image-annotation-in-3d-documentation-and-video-tutorial" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Similar to the the exercise before, but this time use the <code class="docutils literal notranslate"><span class="pre">Annotator</span> <span class="pre">3d</span></code>, from <code class="docutils literal notranslate"><span class="pre">Plugins</span> <span class="pre">&gt;</span> <span class="pre">Segment</span> <span class="pre">Anything</span> <span class="pre">for</span> <span class="pre">Microscopy</span></code></p></li>
</ul>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Note that computing embeddings for the whole stack will, expectedly, take a longer time than for a single 2d image!</p>
</aside>
<ul class="simple">
<li><p>Use either bounding boxes or point prompts to segment (<code class="docutils literal notranslate"><span class="pre">S</span></code> key) a few slices across the stack. Then, click <code class="docutils literal notranslate"><span class="pre">Segment</span> <span class="pre">Stack</span></code> to predict the segmentation in the rest of the intermediate slices. Go through all of them and correct the ones that are wrong using manual prompts.</p></li>
<li><p>Once you finish, you can <code class="docutils literal notranslate"><span class="pre">Commit</span></code> the 3D annotation.</p></li>
</ul>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/3d_annotation.png"><img alt="../_images/3d_annotation.png" src="../_images/3d_annotation.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 52 </span><span class="caption-text">3D annotation (volume view)</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="bonus-exercise-try-samj-in-fiji">
<h3>Bonus Exercise: try SAMJ in Fiji<a class="headerlink" href="#bonus-exercise-try-samj-in-fiji" title="Link to this heading">#</a></h3>
<p>SAMJ is an implementation of SAM that can be run in ImageJ/Fiji using a plugin.</p>
<ul class="simple">
<li><p>Install the SAMJ-IJ for Fiji/ImageJ following the installation guide <a class="reference external" href="https://github.com/segment-anything-models-java/SAMJ-IJ?tab=readme-ov-file#model-installation">HERE</a></p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">Plugins</span> <span class="pre">&gt;</span> <span class="pre">SAMJ</span> <span class="pre">&gt;</span> <span class="pre">SAMJ</span> <span class="pre">annotator</span></code></p></li>
<li><p>Check the instructions for installing models <a class="reference external" href="https://github.com/segment-anything-models-java/SAMJ-IJ?tab=readme-ov-file#model-installation">HERE</a></p></li>
<li><p>Load one of the sample images you used before, calculate the embeddings and try to segment it following <a class="reference external" href="https://github.com/segment-anything-models-java/SAMJ-IJ?tab=readme-ov-file#annotating-images">the manual</a></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>NOTE
Currently, <strong>SAMj only supports either single channel (grayscale) or 3-channel RGB 2D images</strong>. If you want to work with a multichannel image, you will need to convert it to one of these formats and/or extracting individual frames/slices (for 3D/timelapse datasets) before processing.</p>
</div>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/SAMj_annotator.png"><img alt="../_images/SAMj_annotator.png" src="../_images/SAMj_annotator.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 53 </span><span class="caption-text">3D annotation (volume view)</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>You can use preexisting point annotations (for example, generated using <code class="docutils literal notranslate"><span class="pre">Find</span> <span class="pre">Maxima</span></code>) as prompts by choosing the “Preset Prompts” option.</p>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./MicroSAM"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../BeginnerSegmentation/BeginnerSegmentationPlugins.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Day 4, Session 2 - Interfacing CellProfiler with other software tools via files and plugins</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cellpose/CellposeIntro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Day 5, Session 2 - Segmenting Data with Cellpose</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microsam-segment-anything-model-for-microscopy">MicroSAM: ‘Segment Anything’ Model for Microscopy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-data"><strong>Lab Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-an-image-and-calculating-embeddings">Loading an image and calculating embeddings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#image-annotation-in-2d-documentation-and-video-tutorial">Image annotation in 2D (Documentation  and Video tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotate-an-entire-folder-the-image-series-annotator-documentation-and-video-tutorial">Annotate an entire folder: The image Series Annotator (Documentation and Video tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#image-annotation-in-3d-documentation-and-video-tutorial">Image Annotation in 3D (Documentation and Video Tutorial)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercise-try-samj-in-fiji">Bonus Exercise: try SAMJ in Fiji</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Broad Institute Imaging Platform
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>